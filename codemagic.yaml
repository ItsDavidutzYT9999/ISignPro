workflows:
  isignapp-ios:
    name: Build IPA for device
    environment: {}
    scripts:
      - name: Build and archive IPA
        script: |
          xcodebuild archive \
            -project ISignApp.xcodeproj \
            -scheme ISignApp \
            -sdk iphoneos \
            -archivePath $CM_BUILD_DIR/ISignApp.xcarchive \
            CODE_SIGN_STYLE=Manual \
            CODE_SIGN_IDENTITY="iPhone Developer" \
            PROVISIONING_PROFILE_SPECIFIER="GAC TOYOTA CO."
      - name: Export IPA
        script: |
          xcodebuild -exportArchive \
            -archivePath $CM_BUILD_DIR/ISignApp.xcarchive \
            -exportPath $CM_BUILD_DIR \
            -exportOptionsPlist exportOptions.plist
    artifacts:
      - $CM_BUILD_DIR/*.ipa
    publishing:
      scripts:
        - echo "IPA build complete."
